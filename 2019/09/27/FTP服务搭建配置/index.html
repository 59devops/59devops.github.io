<!DOCTYPE html>





<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=7.4.0">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="59Devops" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":true,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="1、什么是文件共享服务？简单来说就是文件域存储块设备可以共享给他人使用。 1.1 实现文件共享服务的三种方式 FTP：属于应用层服务，可以跨平台使用 NFS：属于内核模式，不可以跨平台使用 Samba：可以跨平台使用">
<meta name="keywords" content="Linux,FTP">
<meta property="og:type" content="article">
<meta property="og:title" content="FTP服务搭建配置">
<meta property="og:url" content="http://yoursite.com/2019/09/27/FTP服务搭建配置/index.html">
<meta property="og:site_name" content="59Devops">
<meta property="og:description" content="1、什么是文件共享服务？简单来说就是文件域存储块设备可以共享给他人使用。 1.1 实现文件共享服务的三种方式 FTP：属于应用层服务，可以跨平台使用 NFS：属于内核模式，不可以跨平台使用 Samba：可以跨平台使用">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190702114521.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703095025.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703095051.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703141914.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703142455.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190705170142.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703145738.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703150846.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703162409.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703162439.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703165059.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703164725.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190703165457.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190705150335.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190705150834.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190705154517.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190705154758.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190705161128.png">
<meta property="og:image" content="http://static.staryjie.com/static/images/20190705161328.png">
<meta property="og:updated_time" content="2019-09-27T06:46:09.703Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FTP服务搭建配置">
<meta name="twitter:description" content="1、什么是文件共享服务？简单来说就是文件域存储块设备可以共享给他人使用。 1.1 实现文件共享服务的三种方式 FTP：属于应用层服务，可以跨平台使用 NFS：属于内核模式，不可以跨平台使用 Samba：可以跨平台使用">
<meta name="twitter:image" content="http://static.staryjie.com/static/images/20190702114521.png">
  <link rel="canonical" href="http://yoursite.com/2019/09/27/FTP服务搭建配置/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>FTP服务搭建配置 | 59Devops</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">59Devops</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">一个运维小菜鸡的个人博客网站。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-tags">
      
    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-categories">
      
    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a class="book-mark-link book-mark-link-fixed" href="#"></a>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
      <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/27/FTP服务搭建配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="StaryJie">
      <meta itemprop="description" content="记录学习、工作和生活中遇到的各种问题。">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="59Devops">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">FTP服务搭建配置

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              
                
              

              <time title="创建时间：2019-09-27 14:45:08 / 修改时间：14:46:09" itemprop="dateCreated datePublished" datetime="2019-09-27T14:45:08+08:00">2019-09-27</time>
            </span>
          
            

            
          
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/FTP/" itemprop="url" rel="index"><span itemprop="name">FTP</span></a></span>

                
                
              
            </span>
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="1、什么是文件共享服务？"><a href="#1、什么是文件共享服务？" class="headerlink" title="1、什么是文件共享服务？"></a>1、什么是文件共享服务？</h3><p>简单来说就是文件域存储块设备可以共享给他人使用。</p>
<h4 id="1-1-实现文件共享服务的三种方式"><a href="#1-1-实现文件共享服务的三种方式" class="headerlink" title="1.1 实现文件共享服务的三种方式"></a>1.1 实现文件共享服务的三种方式</h4><ol>
<li>FTP：属于应用层服务，可以跨平台使用</li>
<li>NFS：属于内核模式，不可以跨平台使用</li>
<li><p>Samba：可以跨平台使用</p>
<a id="more"></a>
<h4 id="1-2-实现存储设备域服务器连接的三种方式"><a href="#1-2-实现存储设备域服务器连接的三种方式" class="headerlink" title="1.2 实现存储设备域服务器连接的三种方式"></a>1.2 实现存储设备域服务器连接的三种方式</h4></li>
<li><p>DAS：连接磁盘</p>
</li>
<li>NAS：通过nfs/cifs协议实现网络文件共享(文件存储方式)，电子邮件、网页服务器、多媒体流服务、档案分享等就适用于NAS存储架构</li>
<li>SAS：通过网线或者光纤实现ISCSI和FCSAN将物理存储设备连接起来使用(块存储方式比较底层，需要格式化并挂载当本地磁盘使用)，数据库有关的应用适用于SAS存储架构</li>
</ol>
<h3 id="2、FTP简介"><a href="#2、FTP简介" class="headerlink" title="2、FTP简介"></a>2、FTP简介</h3><p>FTP是File Transfer Protocol文件传输协议的缩写，基于网络来传输文件的应用层协议。</p>
<p>FTP能够通过网络来传输文件，主要是因为工作再应用层所以不会受到平台的限制。</p>
<h4 id="2-1-FTP的工作方式"><a href="#2-1-FTP的工作方式" class="headerlink" title="2.1 FTP的工作方式"></a>2.1 FTP的工作方式</h4><p><img src="http://static.staryjie.com/static/images/20190702114521.png" alt></p>
<p>客户端通过TCP三次握手与服务端建立连接，连接建立成功之后才可以进行文件传输。</p>
<ol>
<li>FTP的数据传输分为命令数据与文件数据，命令传输的就是客户端要执行的命令，服务端收到后返回给客户端执行结果，如ls命令就返回给当前目录下的所有文件个目录。文件传输就是客户端要传输的数据，服务端与客户端连接来传输文件数据。</li>
<li>FTP的服务端与客户端建立连接大体有三个步骤，建立连接、传输数据、断开连接。</li>
<li>FTP是基于TCP协议来传输数据的，使用21端口来建立认证通道，20端口来建立数据通道。</li>
<li>FTP是明文传输的。</li>
<li>FTP的用户可以分为实体用户(real user)，匿名用户(anonymous user)，访客用户(guest user)。</li>
</ol>
<h4 id="2-2-FTP的工作模式"><a href="#2-2-FTP的工作模式" class="headerlink" title="2.2 FTP的工作模式"></a>2.2 FTP的工作模式</h4><p>由于现在的网络架构中都会有防火墙来阻止端口与高位端口被主动连接，特别20端口是被禁止主动连接的，因为20端口是FTP的数据端口，所以为了解决客户端或者服务端的防火墙问题，FTP就有了主动和被动两种工作模式，通过防火墙内的一端来主动连接防火墙外端的一方，这样子就不会被防火墙阻拦。</p>
<h5 id="2-2-1-主动模式"><a href="#2-2-1-主动模式" class="headerlink" title="2.2.1 主动模式"></a>2.2.1 主动模式</h5><p><img src="http://static.staryjie.com/static/images/20190703095025.png" alt></p>
<p>一般用于服务端存在防火墙的情况，客户端无法主动连接到服务端的20数据端口，需要由服务端主动连接到客户端的两个端口。</p>
<ol>
<li>两端在建立TCP通信通道后，客户端会发送port请求与服务端的21端口认证连接并开放用来建立数据连接的高位端口。</li>
<li>服务端在收到请求后，会通过20端口发送ACK响应请求。</li>
<li>服务端通过20端口与客户端发送的高位端口建立数据连接通道。</li>
</ol>
<h5 id="2-2-2-被动模式"><a href="#2-2-2-被动模式" class="headerlink" title="2.2.2 被动模式"></a>2.2.2 被动模式</h5><p><img src="http://static.staryjie.com/static/images/20190703095051.png" alt></p>
<p>一般用于客户端存在防火墙的情况，服务端在收到连接请求后因为客户端存在防火墙而无法达到客户端高位端口，需要客户端主动连接至服务端的数据传输端口。</p>
<ol>
<li>两端在建立TCP通信通道连接后，客户端会发送PASV请求给服务端。</li>
<li>服务端在收到PASV请求后就会打开一个高位端口作为数据传输端口来响应给客户端等待客户端连接。</li>
<li>客户端在收到响应后，就会去连接服务端响应的端口建立数据传输通道。</li>
</ol>
<h4 id="2-3-FTP的用户类型"><a href="#2-3-FTP的用户类型" class="headerlink" title="2.3 FTP的用户类型"></a>2.3 FTP的用户类型</h4><ol>
<li><p>匿名用户</p>
<p>anonymous或ftp</p>
</li>
<li><p>本地用户</p>
<p>账号名称、密码等信息保存在passwd、shadow文件中</p>
</li>
<li><p>虚拟用户</p>
<p>使用独立的账号/密码数据文件</p>
<p>user_list ftp_user1  123456  /var/pub</p>
</li>
</ol>
<h3 id="3、VSFTPD的安装及使用"><a href="#3、VSFTPD的安装及使用" class="headerlink" title="3、VSFTPD的安装及使用"></a>3、VSFTPD的安装及使用</h3><p>官方网站：<a href="http://vsftpd.beasts.org" target="_blank" rel="noopener">http://vsftpd.beasts.org</a></p>
<h4 id="3-1-关闭防火墙和SELINUX"><a href="#3-1-关闭防火墙和SELINUX" class="headerlink" title="3.1 关闭防火墙和SELINUX"></a>3.1 关闭防火墙和SELINUX</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.关闭防火墙</span></span><br><span class="line">systemctl stop firewalld.service</span><br><span class="line">systemctl disabled firewalled.service</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.关闭SELINUX</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2.1 永久关闭，需要重启服务器</span></span></span><br><span class="line">sed -i 's#SELINUX=enforcing#SELINUX=disabled#g' /etc/sysconfig/selinux</span><br><span class="line">reboot</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2.2 临时关闭</span></span></span><br><span class="line">setenforce 0</span><br></pre></td></tr></table></figure>
<h4 id="3-2-安装vsftpd"><a href="#3-2-安装vsftpd" class="headerlink" title="3.2 安装vsftpd"></a>3.2 安装vsftpd</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y vsftpd</span><br></pre></td></tr></table></figure>
<h4 id="3-3-查看安装生成的文件"><a href="#3-3-查看安装生成的文件" class="headerlink" title="3.3 查看安装生成的文件"></a>3.3 查看安装生成的文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[root@ftp ~]# rpm -qa|grep vsftpd</span><br><span class="line">vsftpd-3.0.2-25.el7.x86_64</span><br><span class="line">[root@ftp ~]# rpm -ql vsftpd</span><br><span class="line">/etc/logrotate.d/vsftpd</span><br><span class="line">/etc/pam.d/vsftpd					# pam认证文件</span><br><span class="line">/etc/vsftpd</span><br><span class="line">/etc/vsftpd/ftpusers			# 限制登录文件</span><br><span class="line">/etc/vsftpd/user_list</span><br><span class="line">/etc/vsftpd/vsftpd.conf		# 主配置文件</span><br><span class="line">/etc/vsftpd/vsftpd_conf_migrate.sh</span><br><span class="line">/usr/lib/systemd/system-generators/vsftpd-generator</span><br><span class="line">/usr/lib/systemd/system/vsftpd.service</span><br><span class="line">/usr/lib/systemd/system/vsftpd.target</span><br><span class="line">/usr/lib/systemd/system/vsftpd@.service</span><br><span class="line">/usr/sbin/vsftpd					# 程序文件</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/AUDIT</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/BENCHMARKS</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/BUGS</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/COPYING</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/Changelog</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE/README</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE/README.configuration</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE/vsftpd.conf</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE/vsftpd.xinetd</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE_NOINETD</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE_NOINETD/README</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE_NOINETD/README.configuration</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/INTERNET_SITE_NOINETD/vsftpd.conf</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/PER_IP_CONFIG</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/PER_IP_CONFIG/README</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/PER_IP_CONFIG/README.configuration</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/PER_IP_CONFIG/hosts.allow</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/README</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_HOSTS</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_HOSTS/README</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_USERS</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_USERS/README</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_USERS/README.configuration</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_USERS/logins.txt</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_USERS/vsftpd.conf</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_USERS/vsftpd.pam</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_USERS_2</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/EXAMPLE/VIRTUAL_USERS_2/README</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/FAQ</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/INSTALL</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/LICENSE</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/README</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/README.security</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/REWARD</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/SECURITY</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/SECURITY/DESIGN</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/SECURITY/IMPLEMENTATION</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/SECURITY/OVERVIEW</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/SECURITY/TRUST</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/SIZE</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/SPEED</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/TODO</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/TUNING</span><br><span class="line">/usr/share/doc/vsftpd-3.0.2/vsftpd.xinetd</span><br><span class="line">/usr/share/man/man5/vsftpd.conf.5.gz</span><br><span class="line">/usr/share/man/man8/vsftpd.8.gz</span><br><span class="line">/var/ftp									# FTP家目录</span><br><span class="line">/var/ftp/pub</span><br><span class="line">[root@ftp ~]#</span><br></pre></td></tr></table></figure>
<h4 id="3-4-基于匿名用户的访问控制"><a href="#3-4-基于匿名用户的访问控制" class="headerlink" title="3.4 基于匿名用户的访问控制"></a>3.4 基于匿名用户的访问控制</h4><p>要配置基于匿名用户的访问控制，需要修改vsftpd的主配置文件<code>/etc/vsftpd/vsftpd.conf</code>，主要有下面几个参数：</p>
<ul>
<li>anonymous_enable=YES：启用匿名用户</li>
<li>anon_upload_enable=YES：允许匿名用户上传文件</li>
<li>anon_mkdir_write_enable=YES：是否允许匿名用户创建目录，要考虑文件系统上的家目录，必须要有写权限</li>
<li>anon_other_write_enable=YES：允许匿名用户更多于上传或者建立目录之外的权限，譬如删除或者重命名</li>
<li>anon_umask=077：指定上传文件的默认所有者和权限</li>
</ul>
<h5 id="3-4-1-运行匿名用户登录"><a href="#3-4-1-运行匿名用户登录" class="headerlink" title="3.4.1 运行匿名用户登录"></a>3.4.1 运行匿名用户登录</h5><p>不修改配置文件直接启动后，直接通过FTP软件连接即可，用户名默认是ftp，没有密码。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start vsftpd.service</span><br></pre></td></tr></table></figure>
<p><img src="http://static.staryjie.com/static/images/20190703141914.png" alt></p>
<p>但是此时匿名用户是不能上传文件和创建目录的：</p>
<p><img src="http://static.staryjie.com/static/images/20190703142455.png" alt></p>
<h5 id="3-4-2-运行匿名用户上传文件、创建目录"><a href="#3-4-2-运行匿名用户上传文件、创建目录" class="headerlink" title="3.4.2 运行匿名用户上传文件、创建目录"></a>3.4.2 运行匿名用户上传文件、创建目录</h5><p>开启允许匿名用户上传文件和创建文件夹的权限：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/vsftpd/</span><br><span class="line">vim vsftpd.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 开启下面三个权限</span></span><br><span class="line">anonymous_enable=YES</span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入ftp家目录，创建一个文件夹并授权</span></span><br><span class="line">[root@ftp ~]# cd /var/ftp/</span><br><span class="line">[root@ftp ftp]# mkdir -p ./testdir</span><br><span class="line">[root@ftp ftp]# setfacl -m u:ftp:rwx ./testdir/</span><br><span class="line">[root@ftp ftp]# getfacl ./testdir/</span><br><span class="line"><span class="meta">#</span><span class="bash"> file: testdir/</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> owner: root</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> group: root</span></span><br><span class="line">user::rwx</span><br><span class="line">user:ftp:rwx</span><br><span class="line">group::r-x</span><br><span class="line">mask::rwx</span><br><span class="line">other::r-x</span><br><span class="line">[root@ftp ftp]#</span><br></pre></td></tr></table></figure>
<p>重新登录ftp，在testdir目录中可以创建目录和上传文件，但是却没有删除文件和重命名文件的权限。</p>
<p><img src="http://static.staryjie.com/static/images/20190705170142.png" alt></p>
<h5 id="3-4-3-开启匿名用户删除和重命名权限"><a href="#3-4-3-开启匿名用户删除和重命名权限" class="headerlink" title="3.4.3 开启匿名用户删除和重命名权限"></a>3.4.3 开启匿名用户删除和重命名权限</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 增加下面的内容，重启vsftpd服务</span></span><br><span class="line">anon_other_write_enable=YES</span><br><span class="line">systemctl restart vsftpd.service</span><br></pre></td></tr></table></figure>
<p>测试删除文件和重命名：</p>
<p><img src="http://static.staryjie.com/static/images/20190703145738.png" alt></p>
<h4 id="3-5-基于本地用户的访问控制"><a href="#3-5-基于本地用户的访问控制" class="headerlink" title="3.5 基于本地用户的访问控制"></a>3.5 基于本地用户的访问控制</h4><p>默认情况下，操作系统的账户是可以直接使用用户名和密码登陆的。并且登陆之后，默认进入自己的家目录。</p>
<p>基于本地用户的访问控制也通过修改vsftpd的配置文件来实现，主要有一下几个参数：</p>
<ol>
<li>local_enable=YES：是否允许Linux用户登录，默认是允许的，当然也可以禁止</li>
<li>write_enable=YES：是否允许系统用户上传文件</li>
<li>local_root=/ftproot：非匿名用户登录所在目录，当使用Linux用户登录成功之后，就不会默认在自己的家目录了。相反，会位于指定的目录之下</li>
<li>local_umask=022：指定系统用户上传文件的默认权限</li>
</ol>
<h5 id="3-5-1-允许系统用户登录并上传文件"><a href="#3-5-1-允许系统用户登录并上传文件" class="headerlink" title="3.5.1 允许系统用户登录并上传文件"></a>3.5.1 允许系统用户登录并上传文件</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认以下三个参数都是开启的</span></span><br><span class="line">local_enable=YES</span><br><span class="line">write_enable=YES</span><br><span class="line">local_umask=022</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加一个系统用户并设置密码</span></span><br><span class="line">useradd centos</span><br><span class="line">echo "123456"|passwd --stdin centos</span><br></pre></td></tr></table></figure>
<p>系统用户默认具有上传文件、创建目录、删除和重命名的权限。</p>
<p><img src="http://static.staryjie.com/static/images/20190703150846.png" alt></p>
<p>系统用户默认也可以进入其他目录，所以并不安全，所以如果要启用系统用户登陆FTP那么就要修改配置文件，禁止系统用户访问除了家目录以外的其他目录。</p>
<h5 id="3-5-2-配置本地用户只能访问自己的家目录"><a href="#3-5-2-配置本地用户只能访问自己的家目录" class="headerlink" title="3.5.2 配置本地用户只能访问自己的家目录"></a>3.5.2 配置本地用户只能访问自己的家目录</h5><p>修改vsftpd.conf配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 开启下面的参数</span></span><br><span class="line">chroot_local_user=YES</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个参数是全局的，开启后所有的本地用户都不能访问除了家目录以外的目录</span></span><br></pre></td></tr></table></figure>
<p>但是开启这个参数之后，由于vsftpd更新到2.3.5之后，vsftpd增强了安全检查，如果用户被限定在了其主目录下，则该用户的主目录不能再具有写权限了！如果检查发现还有写权限，就会报该错误。</p>
<p>要解决这个错误有两种方式：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.方式一：将对应家目录的写权限去除</span></span><br><span class="line">chmod a-w /home/centos</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.方式二：在配置文件在加入下面的参数</span></span><br><span class="line">allow_writeable_chroot=YES</span><br></pre></td></tr></table></figure>
<h5 id="3-5-3-配置指定的本地用户只能访问家目录"><a href="#3-5-3-配置指定的本地用户只能访问家目录" class="headerlink" title="3.5.3 配置指定的本地用户只能访问家目录"></a>3.5.3 配置指定的本地用户只能访问家目录</h5><p>配置指定用户只能访问家目录，其他用户可以访问其他目录，需要在配置文件中关闭全局设置的参数<code>allow_writeable_chroot=YES</code>，开启下面两个参数：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chroot_list_enable=YES</span><br><span class="line">chroot_list_file=/etc/vsftpd/chroot_list</span><br></pre></td></tr></table></figure>
<p>然后需要创建指定的文件<code>chroot_list</code>并在文件中指定对应的用户：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/chroot_list</span><br><span class="line"><span class="meta">#</span><span class="bash"> 限制只能在家目录</span></span><br><span class="line">centos</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启vsftpd服务</span></span><br><span class="line">systemctl restart vsftpd.service</span><br><span class="line"><span class="meta">#</span><span class="bash"> 新建一个用户并设置密码</span></span><br><span class="line">useradd redhat</span><br><span class="line">echo "123456"|passwd --stdin redhat</span><br></pre></td></tr></table></figure>
<p>用centos用户访问，只能在自己的家目录中：</p>
<p><img src="http://static.staryjie.com/static/images/20190703162409.png" alt></p>
<p>用redhat用户访问，可以访问除了家目录以外的其他目录：</p>
<p><img src="http://static.staryjie.com/static/images/20190703162439.png" alt></p>
<h4 id="3-6-设置chroot"><a href="#3-6-设置chroot" class="headerlink" title="3.6 设置chroot"></a>3.6 设置chroot</h4><p>在默认配置中，本地用户可以切换到自己家目录以外的其他目录进行浏览，并在权限许可的范围内进行下载和上传。这样的设置对于一个FTP服务器来说是不安全的。</p>
<p>如果希望本地用户登录之后不能访问除了家目录以外的目录，则需要设置chroot选项，具体设置下面三个选项：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chroot_local_user</span><br><span class="line">chroot_list_enable</span><br><span class="line">chroot_list_file</span><br></pre></td></tr></table></figure>
<h5 id="3-6-1-设置所有用户只需chroot"><a href="#3-6-1-设置所有用户只需chroot" class="headerlink" title="3.6.1 设置所有用户只需chroot"></a>3.6.1 设置所有用户只需chroot</h5><p>只需要将<code>chroot_local_user</code>选项设置为<code>YES</code>，所有的本地用户都只能访问自己的家目录。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chroot_local_user=YES</span><br></pre></td></tr></table></figure>
<h5 id="2-6-2-设置部分指定用户执行chroot"><a href="#2-6-2-设置部分指定用户执行chroot" class="headerlink" title="2.6.2 设置部分指定用户执行chroot"></a>2.6.2 设置部分指定用户执行chroot</h5><p>需要注释全局的设置或者设为NO，然后开启另外两个选项：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chroot_local_user=NO</span><br><span class="line">chroot_list_enable=YES</span><br><span class="line">chroot_list_file=/etc/vaftpd/chroot_list</span><br></pre></td></tr></table></figure>
<p>这样，文件<code>/etc/vaftpd/chroot_list</code>中的用户就只能访问自己的家目录，其他本地用户可以访问除了家目录的其他目录。</p>
<p>配置基于本地用户的访问限制，需要修改配置文件，主要有以下两种方式：</p>
<ol>
<li><p>限制指定的本地用户不能访问，而其他本地用户可以访问</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">userlist_enable=YES</span><br><span class="line">userlist_deny=YES</span><br><span class="line">userlist_file=/etc/vsftpd/user_list</span><br></pre></td></tr></table></figure>
<p>使文件/etc/vsftpd/user_list中指定的本地用户不能访问FTP服务器，而其他的本地用户可以访问FTP服务器。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">userlist_enable=YES</span><br><span class="line">userlist_deny=NO</span><br><span class="line">userlist_file=/etc/vsftpd/user_list</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h4 id="3-7-提示信息"><a href="#3-7-提示信息" class="headerlink" title="3.7 提示信息"></a>3.7 提示信息</h4><h5 id="3-7-1-登陆提示信息"><a href="#3-7-1-登陆提示信息" class="headerlink" title="3.7.1 登陆提示信息"></a>3.7.1 登陆提示信息</h5><p>登陆提示信息图形界面(FTP软件)是看不到的，只适用于ftp作为客户端的时候。可以使用下面的方式进行配置。但是优先级却不一样。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 如果限制用户只能访问家目录，下面这个配置优先生效</span></span><br><span class="line">ftpd_banner="Welcome to Mage Ftp Server!"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下面这个优先级较上一个配置低</span></span><br><span class="line">banner_file=/etc/vsftpd/ftpbanner.txt</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 其他情况当两个配置都在的时候，默认banner_file的优先生效</span></span><br></pre></td></tr></table></figure>
<p><img src="http://static.staryjie.com/static/images/20190703165059.png" alt></p>
<p><img src="http://static.staryjie.com/static/images/20190703164725.png" alt></p>
<h5 id="3-7-2-访问目录提示信息"><a href="#3-7-2-访问目录提示信息" class="headerlink" title="3.7.2 访问目录提示信息"></a>3.7.2 访问目录提示信息</h5><p>当用户进入某一目录后，可以给用户一个提示消息。用来提示这个目录的作用。在相应的目录下新建一个隐藏文件<code>.message</code>，该文件中进行提示信息描述。需要添加如下配置：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dirmessage_enable=YES</span><br><span class="line">message_file=.message</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在/var/ftp/pub下新建.message</span></span><br><span class="line">vim /var/ftp/pub/.message</span><br><span class="line">This is the public floder.</span><br></pre></td></tr></table></figure>
<p><img src="http://static.staryjie.com/static/images/20190703165457.png" alt></p>
<h4 id="3-8-进一步配置VSFTPD"><a href="#3-8-进一步配置VSFTPD" class="headerlink" title="3.8 进一步配置VSFTPD"></a>3.8 进一步配置VSFTPD</h4><h5 id="3-8-1-最大传输速率限制"><a href="#3-8-1-最大传输速率限制" class="headerlink" title="3.8.1 最大传输速率限制"></a>3.8.1 最大传输速率限制</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">local_max_rate=50000</span><br><span class="line">anon_max_rate=30000</span><br></pre></td></tr></table></figure>
<p>上面的设置是将本地用户的最大传输速率限制为50kbytes/s，匿名用户最大传输速率限制为30kbytes/s。</p>
<h5 id="3-8-2-设置客户端连接时的端口范围"><a href="#3-8-2-设置客户端连接时的端口范围" class="headerlink" title="3.8.2 设置客户端连接时的端口范围"></a>3.8.2 设置客户端连接时的端口范围</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pasv_min_port=50000</span><br><span class="line">pasv_max_port=60000</span><br></pre></td></tr></table></figure>
<p>上面的设置将客户端连接时的端口范围限制在50000-60000之间，提高系统安全性。</p>
<h5 id="3-8-3-基本性能和安全选项配置"><a href="#3-8-3-基本性能和安全选项配置" class="headerlink" title="3.8.3 基本性能和安全选项配置"></a>3.8.3 基本性能和安全选项配置</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.设置空闲用户会话中断时间(单位:秒)</span></span><br><span class="line">idle_session_timeout=6000</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.设置空闲的数据连接的终端时间(单位:秒)</span></span><br><span class="line">date_connection_timeout=120</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3.设置客户端空闲时的自动中断和激活连接时间(单位:秒)</span></span><br><span class="line">accept_timeout=60</span><br><span class="line">connect_timeout=60</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上面的配置将是客户端1分钟后自动中断，在中断一分钟后自动激活连接</span></span><br></pre></td></tr></table></figure>
<h3 id="4、VSFTPD虚拟用户"><a href="#4、VSFTPD虚拟用户" class="headerlink" title="4、VSFTPD虚拟用户"></a>4、VSFTPD虚拟用户</h3><h4 id="4-1-虚拟用户"><a href="#4-1-虚拟用户" class="headerlink" title="4.1 虚拟用户"></a>4.1 虚拟用户</h4><ul>
<li>所有虚拟用户会统一映射为一个指定的系统账号：访问共享设置，即为此系统账号的家目录。</li>
<li>各虚拟账户可以被赋予不同的访问权限，通过匿名用户的权限控制参数进行指定。</li>
</ul>
<h4 id="4-2-虚拟账号的存储方式"><a href="#4-2-虚拟账号的存储方式" class="headerlink" title="4.2 虚拟账号的存储方式"></a>4.2 虚拟账号的存储方式</h4><h5 id="4-2-1-文本"><a href="#4-2-1-文本" class="headerlink" title="4.2.1 文本"></a>4.2.1 文本</h5><p>编辑文本文件，该文件需要被编码为hash格式。奇数行为用户名、偶数行为密码。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db_load -T -t hash -f vusers.txt vusers.db</span><br></pre></td></tr></table></figure>
<ul>
<li><p>基于文件验证的vsftpd虚拟用户</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.创建用户数据库文件</span></span><br><span class="line">vim /etc/vsftpd/vusers.txt</span><br><span class="line">zhangsan</span><br><span class="line">123456</span><br><span class="line">lisi</span><br><span class="line">123456</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 生成数据库文件</span></span><br><span class="line">cd /etc/vsftpd/</span><br><span class="line">db_load -T -t hash -f vusers.txt vusers.db</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3.修改数据库文件权限</span></span><br><span class="line">chmod 600 ./vusers.db</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 4.创建系统用户和访问FTP目录</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建系统用户并指定家目录</span></span><br><span class="line">useradd -d /var/ftproot -s /sbin/nologin vuser</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改家目录权限</span></span><br><span class="line">chmod +rwx /var/ftproot</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 5.创建pam配置文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改pam配置文件，让vsftpd支持pam模块进行身份验证</span></span><br><span class="line">vim /etc/pam.d/vsftpd.db</span><br><span class="line">auth required pam_userdb.so db=/etc/vsftpd/vusers</span><br><span class="line">account required pam_userdb.so db=/etc/vsftpd/vusers</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 6.修改vsftpd主配置文件指定pam配置文件</span></span><br><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br><span class="line">guest_enable=YES</span><br><span class="line">guest_username=vuser</span><br><span class="line">pam_service_name=vsftpd.db</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 7.修改虚拟用户权限配置</span></span><br><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br><span class="line">user_config_dir=/etc/vsftpd/vusers.d/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建配置目录并给用户设置权限(权限配置文件与用户名一样)</span></span><br><span class="line">mkdir -p /etc/vsftpd/vusers.d/</span><br><span class="line">cd /etc/vsftpd/vusers.d/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 给zhangsan设置权限</span></span><br><span class="line">vim zhangsan</span><br><span class="line"><span class="meta">#</span><span class="bash"> 虚拟用户上传权限</span></span><br><span class="line">anon_upload_enable=YES</span><br><span class="line"><span class="meta">#</span><span class="bash"> 虚拟用户创建文件夹</span></span><br><span class="line">anon_mkdir_write_enable=NO</span><br><span class="line"><span class="meta">#</span><span class="bash"> 虚拟的其他用户对指定用户目录的写权限</span></span><br><span class="line">anon_other_write_enable=NO</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改登录目录至其他目录</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> local_root=/ftproot</span></span><br></pre></td></tr></table></figure>
<p>重启vsftpd服务，用zhangsan用户登录，只能上传文件，不能创建文件夹和删除文件：</p>
<p><img src="http://static.staryjie.com/static/images/20190705150335.png" alt></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 给lisi配置权限</span></span><br><span class="line">cd /etc/vsftpd/vusers.d/</span><br><span class="line">vim lisi</span><br><span class="line"><span class="meta">#</span><span class="bash"> 虚拟用户上传权限</span></span><br><span class="line">anon_upload_enable=YES</span><br><span class="line"><span class="meta">#</span><span class="bash"> 虚拟用户创建文件夹</span></span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line"><span class="meta">#</span><span class="bash"> 虚拟的其他用户对指定用户目录的写权限</span></span><br><span class="line">anon_other_write_enable=YES</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改登录目录至其他目录</span></span><br><span class="line"><span class="meta">#</span><span class="bash">local_root=/ftproot</span></span><br></pre></td></tr></table></figure>
<p>重启vsftpd服务，用lisi账号登陆，可以上传、新建、删除：</p>
<p><img src="http://static.staryjie.com/static/images/20190705150834.png" alt></p>
</li>
</ul>
<h5 id="4-2-2-关系型数据库"><a href="#4-2-2-关系型数据库" class="headerlink" title="4.2.2 关系型数据库"></a>4.2.2 关系型数据库</h5><p>实时查询数据库完成用户认证。</p>
<ul>
<li><p>MySQL</p>
<p><a href="https://www.cnblogs.com/zhenhui/p/5916116.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhenhui/p/5916116.html</a></p>
<p>pam需要依赖于pam_mysql</p>
<ul>
<li>/lib/security/pam_mysql.so</li>
<li>/usr/share/doc/pam_mysql-0.7/README</li>
</ul>
</li>
</ul>
<ol>
<li>安装MySQL及pam_mysql插件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install -y mariadb-server pam-devel mariadb-devel vsftpd ftp</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载pam_mysql源码包</span></span><br><span class="line">wget http://www.huzs.net/soft/vsftpd/pam_mysql-0.7RC1.tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 编译安装pam_mysql</span></span><br><span class="line">tar xf pam_mysql-0.7RC1.tar.gz &amp;&amp; cd pam_mysql-0.7RC1</span><br><span class="line">./configure --with-openssl --with-pam-mods-dir=/lib/security/</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<ol>
<li>创建vsftpd数据库和用户表</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动数据库</span></span><br><span class="line">systemctl enable mariadb.service</span><br><span class="line">systemctl start mariadb.service</span><br><span class="line"><span class="meta">#</span><span class="bash"> 初始化数据库</span></span><br><span class="line">/usr/bin/mysql_secure_installation</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> vsftpd;</span><br><span class="line"><span class="keyword">use</span> vsftpd;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> (</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">int</span> AUTO_INCREMENT <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">20</span>) <span class="built_in">binary</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="keyword">password</span> <span class="built_in">char</span>(<span class="number">48</span>) <span class="built_in">binary</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  primary <span class="keyword">key</span>(<span class="keyword">id</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p><img src="http://static.staryjie.com/static/images/20190705154517.png" alt></p>
<ol>
<li>创建虚拟用户</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">users</span>(<span class="keyword">name</span>,<span class="keyword">password</span>) <span class="keyword">values</span>(<span class="string">'jack'</span>,<span class="keyword">PASSWORD</span>(<span class="string">'123456'</span>)),(<span class="string">'tom'</span>,<span class="keyword">PASSWORD</span>(<span class="string">'123456'</span>));</span><br></pre></td></tr></table></figure>
<p><img src="http://static.staryjie.com/static/images/20190705154758.png" alt></p>
<ol>
<li>授权</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> vsftpd.* <span class="keyword">TO</span> <span class="string">'vsftpd'</span>@<span class="string">'localhost'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'vsftpdpass'</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">ALL</span> <span class="keyword">ON</span> vsftpd.* <span class="keyword">TO</span> <span class="string">'vsftpd'</span>@<span class="string">'127.0.0.1'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">'vsftpdpass'</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></table></figure>
<ol>
<li>配置pam认证</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.建立pam认证所需文件</span></span><br><span class="line">vim /etc/pam.d/vsftpd.mysql</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.添加下面两行</span></span><br><span class="line">auth required /lib/security/pam_mysql.so user=vsftpd passwd=vsftpdpass host=127.0.0.1 db=vsftpd table=users usercolumn=name passwdcolumn=password crypt=2</span><br><span class="line">account required /lib/security/pam_mysql.so user=vsftpd passwd=vsftpdpass host=127.0.0.1 db=vsftpd table=users usercolumn=name passwdcolumn=password crypt=2</span><br></pre></td></tr></table></figure>
<ol>
<li>创建虚拟用户的映射用户</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">useradd -s /sbin/nologin -d /var/ftproot vuser</span><br><span class="line">setfacl -m u:vuser:rwx /var/ftproot</span><br></pre></td></tr></table></figure>
<ol>
<li>修改vsftpd的配置文件，使其适应mysql认证</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br><span class="line">pam_service_name=vsftpd.mysql</span><br><span class="line">guest_enable=YES</span><br><span class="line">guest_username=vuser</span><br></pre></td></tr></table></figure>
<ol>
<li>配置虚拟用户具有不同的访问权限</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.配置虚拟用户有单独的权限设定</span></span><br><span class="line">vim /etc/vsftpd/vsftpd.conf</span><br><span class="line">user_config_dir=/etc/vsftpd/vusers_conf</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.创建所需目录，并为虚拟用户提供配置文件</span></span><br><span class="line">mkdir /etc/vsftpd/vusers_conf</span><br><span class="line">cd /etc/vsftpd/vusers_conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置虚拟用户具有不同的访问权限</span></span><br><span class="line">vim jack</span><br><span class="line"><span class="meta">#</span><span class="bash"> 写入以下内容</span></span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=YES</span><br><span class="line">anon_other_write_enable=YES</span><br><span class="line"></span><br><span class="line">vim tom</span><br><span class="line"><span class="meta">#</span><span class="bash"> 写入以下内容</span></span><br><span class="line">anon_upload_enable=YES</span><br><span class="line">anon_mkdir_write_enable=NO</span><br><span class="line">anon_other_write_enable=NO</span><br></pre></td></tr></table></figure>
<ol>
<li>重启vsftpd服务并测试</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart vsftpd.service</span><br></pre></td></tr></table></figure>
<p>登陆jack账户，有上传、新建、删除、重命名的权限：</p>
<p><img src="http://static.staryjie.com/static/images/20190705161128.png" alt></p>
<p>登陆tom账户，只有上传的权限：</p>
<p><img src="http://static.staryjie.com/static/images/20190705161328.png" alt></p>

    </div>

    
    
    
        
      

      <footer class="post-footer">
          
            
          
          <div class="post-tags">
            
              <a href="/tags/Linux/" rel="tag"># Linux</a>
            
              <a href="/tags/FTP/" rel="tag"># FTP</a>
            
          </div>
        

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/09/27/Mac下安装Anaconda3/" rel="next" title="Mac下安装Anaconda3">
                  <i class="fa fa-chevron-left"></i> Mac下安装Anaconda3
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/09/30/PHP编译安装完成之后没有-php-ini-文件的处理方法/" rel="prev" title="PHP编译安装完成之后没有'php.ini'文件的处理方法">
                  PHP编译安装完成之后没有'php.ini'文件的处理方法 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          
    
    <div class="comments" id="gitalk-container"></div>
  

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1、什么是文件共享服务？"><span class="nav-number">1.</span> <span class="nav-text">1、什么是文件共享服务？</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-实现文件共享服务的三种方式"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 实现文件共享服务的三种方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-实现存储设备域服务器连接的三种方式"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 实现存储设备域服务器连接的三种方式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2、FTP简介"><span class="nav-number">2.</span> <span class="nav-text">2、FTP简介</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-FTP的工作方式"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 FTP的工作方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-FTP的工作模式"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 FTP的工作模式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-1-主动模式"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.2.1 主动模式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2-2-被动模式"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2.2 被动模式</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-FTP的用户类型"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 FTP的用户类型</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3、VSFTPD的安装及使用"><span class="nav-number">3.</span> <span class="nav-text">3、VSFTPD的安装及使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-关闭防火墙和SELINUX"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 关闭防火墙和SELINUX</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-安装vsftpd"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 安装vsftpd</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-查看安装生成的文件"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 查看安装生成的文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-基于匿名用户的访问控制"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 基于匿名用户的访问控制</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-4-1-运行匿名用户登录"><span class="nav-number">3.4.1.</span> <span class="nav-text">3.4.1 运行匿名用户登录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-4-2-运行匿名用户上传文件、创建目录"><span class="nav-number">3.4.2.</span> <span class="nav-text">3.4.2 运行匿名用户上传文件、创建目录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-4-3-开启匿名用户删除和重命名权限"><span class="nav-number">3.4.3.</span> <span class="nav-text">3.4.3 开启匿名用户删除和重命名权限</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-5-基于本地用户的访问控制"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 基于本地用户的访问控制</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-5-1-允许系统用户登录并上传文件"><span class="nav-number">3.5.1.</span> <span class="nav-text">3.5.1 允许系统用户登录并上传文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-5-2-配置本地用户只能访问自己的家目录"><span class="nav-number">3.5.2.</span> <span class="nav-text">3.5.2 配置本地用户只能访问自己的家目录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-5-3-配置指定的本地用户只能访问家目录"><span class="nav-number">3.5.3.</span> <span class="nav-text">3.5.3 配置指定的本地用户只能访问家目录</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-6-设置chroot"><span class="nav-number">3.6.</span> <span class="nav-text">3.6 设置chroot</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-6-1-设置所有用户只需chroot"><span class="nav-number">3.6.1.</span> <span class="nav-text">3.6.1 设置所有用户只需chroot</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-6-2-设置部分指定用户执行chroot"><span class="nav-number">3.6.2.</span> <span class="nav-text">2.6.2 设置部分指定用户执行chroot</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-7-提示信息"><span class="nav-number">3.7.</span> <span class="nav-text">3.7 提示信息</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-7-1-登陆提示信息"><span class="nav-number">3.7.1.</span> <span class="nav-text">3.7.1 登陆提示信息</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-7-2-访问目录提示信息"><span class="nav-number">3.7.2.</span> <span class="nav-text">3.7.2 访问目录提示信息</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-8-进一步配置VSFTPD"><span class="nav-number">3.8.</span> <span class="nav-text">3.8 进一步配置VSFTPD</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-8-1-最大传输速率限制"><span class="nav-number">3.8.1.</span> <span class="nav-text">3.8.1 最大传输速率限制</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-8-2-设置客户端连接时的端口范围"><span class="nav-number">3.8.2.</span> <span class="nav-text">3.8.2 设置客户端连接时的端口范围</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-8-3-基本性能和安全选项配置"><span class="nav-number">3.8.3.</span> <span class="nav-text">3.8.3 基本性能和安全选项配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4、VSFTPD虚拟用户"><span class="nav-number">4.</span> <span class="nav-text">4、VSFTPD虚拟用户</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-虚拟用户"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 虚拟用户</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-虚拟账号的存储方式"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 虚拟账号的存储方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-2-1-文本"><span class="nav-number">4.2.1.</span> <span class="nav-text">4.2.1 文本</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-2-2-关系型数据库"><span class="nav-number">4.2.2.</span> <span class="nav-text">4.2.2 关系型数据库</span></a></li></ol></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
      src="/images/avatar.png"
      alt="StaryJie">
  <p class="site-author-name" itemprop="name">StaryJie</p>
  <div class="site-description" itemprop="description">记录学习、工作和生活中遇到的各种问题。</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
          
            <a href="/categories/">
          
        
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-tags">
        
          
            <a href="/tags/">
          
        
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span>
        </a>
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">StaryJie</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.4.0</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  <script src="/lib/pjax/pjax.min.js?v=0.2.8"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>
<script src="/js/next-boot.js?v=7.4.0"></script><script src="/js/bookmark.js?v=7.4.0"></script>
  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[pjax], script#page-configurations, #pjax script').forEach(element => {
    var id = element.id || '';
    var src = element.src || '';
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (id !=='') {
      script.id = element.id;
    }
    if (src !== '') {
      script.src = src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  








  <script src="/js/local-search.js?v=7.4.0"></script>













    <div id="pjax">

  

  

  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID: 'cb34a61011c438548cec',
      clientSecret: '3d9c756a081ce2b91a6a286eb1a0a02a71ced6ca',
      repo: '59devops.github.io',
      owner: '59devops',
      admin: ['59devops'],
      id: '6a37672e61255a98d260468e5ec9296c',
        language: 'zh-CN',
      
      distractionFreeMode: 'true'
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
</script>

    </div>
</body>
</html>
